#!/usr/bin/env bash

# Script to open a directory in a new tmux pane
# Usage: tmux-pane [directory] [split-type]
# split-type can be 'h' for horizontal (default) or 'v' for vertical split

# Process arguments
if [[ $# -ge 1 ]]; then
    selected=$1
else
    selected=$(find ~/.config ~/code ~/fun ~/personal ~/work ~/research -mindepth 0 -maxdepth 5 -type d | fzf)
fi

# Exit if no directory was selected
if [[ -z $selected ]]; then
    exit 0
fi

# Set split type (horizontal by default)
split_type="h"
if [[ $# -ge 2 ]]; then
    split_type=$2
fi

# Check if we're in a tmux session
if [[ -z $TMUX ]]; then
    echo "Error: Not in a tmux session"
    echo "Please start or attach to a tmux session first"
    exit 1
fi

# Split the window and open the selected directory in the new pane
if [[ $split_type == "v" ]]; then
    # Vertical split (side by side)
    tmux split-window -h -c "$selected"
else
    # Horizontal split (one above the other)
    tmux split-window -v -c "$selected"
fi